<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>AtSIP</title>
    <link>http://localhost:1313/</link>
    <description>Recent content on AtSIP</description>
    <image>
      <title>AtSIP</title>
      <url>http://localhost:1313/logo.png</url>
      <link>http://localhost:1313/logo.png</link>
    </image>
    <generator>Hugo -- 0.134.2</generator>
    <language>ru</language>
    <lastBuildDate>Fri, 22 Nov 2024 12:51:44 +0500</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Оценка качества обслуживания в Asterisk</title>
      <link>http://localhost:1313/articles/qam/</link>
      <pubDate>Fri, 22 Nov 2024 12:51:44 +0500</pubDate>
      <guid>http://localhost:1313/articles/qam/</guid>
      <description>&lt;p&gt;Поступил заказ сделать модуль оценки работы оператора и качества оказания услуги.&lt;/p&gt;
&lt;p&gt;За основу взял статью &lt;a href=&#34;https://dzen.ru/a/W_ZfFFGEzACpkDVw&#34;&gt;merion networks&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Всё делалось на FreePBX 15 и Asterisk 18.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;В файл /etc/asterisk/queues_post_custom.conf вносим редакцию для нужной очереди (например 500) чтобы получить номер ответившего агента (можно и проще, но не срабатывало с IAX):&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[500](+)
setinterfacevar=yes
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Клепаем само меню в /etc/asterisk/extensions_custom.conf:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[assessment]
exten =&amp;gt; _X.,1,Answer()
     same =&amp;gt; n,Set(CHANNEL(language)=ru)
     same =&amp;gt; n,Set(COUNT=1)
     same =&amp;gt; n,Wait(1)
     same =&amp;gt; n,Playback(custom/qam-intro)
     same =&amp;gt; n,Set(TIMEOUT(digit)=1)
     same =&amp;gt; n,NoOP(Count: ${COUNT})
     same =&amp;gt; n,GotoIf($[&amp;#34;${COUNT}&amp;#34; = &amp;#34;1&amp;#34;]?start-1)
     same =&amp;gt; n,GotoIf($[&amp;#34;${COUNT}&amp;#34; = &amp;#34;2&amp;#34;]?start-2:hh,1)
     same =&amp;gt; n(start-1),Background(custom/qam-question-service,m)       ;озвучиваем предложение об оценке оператора
     same =&amp;gt; n,WaitExten(10)
     same =&amp;gt; n,Goto(t,1)        ;переход к завершению по тайм-ауту
     same =&amp;gt; n(start-2),Background(custom/qam-question-operator,m)      ;озвучиваем предложение об оценке сервиса
     same =&amp;gt; n,WaitExten(10)
     same =&amp;gt; n,Goto(t,1)        ;переход к завершению по тайм-ауту

exten =&amp;gt; 1,1,NoOP(${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 1, ${COUNT})
   same =&amp;gt; n,AGI(survey.php, ${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 1, ${COUNT})  ;если клиент вводит 1, то отправляем даные через AGI в скрипт, который отправляет их в SQL
   same =&amp;gt; n,Set(COUNT=$[${COUNT} + 1])
   same =&amp;gt; n,Goto(_X.,6)

exten =&amp;gt; 2,1,AGI(survey.php, ${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 2, ${COUNT})
   same =&amp;gt; n,Set(COUNT=$[${COUNT} + 1])
   same =&amp;gt; n,Goto(_X.,6)

exten =&amp;gt; 3,1,AGI(survey.php, ${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 3, ${COUNT})
   same =&amp;gt; n,Set(COUNT=$[${COUNT} + 1])
   same =&amp;gt; n,Goto(_X.,6)

exten =&amp;gt; 4,1,AGI(survey.php, ${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 4, ${COUNT})
   same =&amp;gt; n,Set(COUNT=$[${COUNT} + 1])
   same =&amp;gt; n,Goto(_X.,6)

exten =&amp;gt; 5,1,AGI(survey.php, ${CDR(src)}, ${DIALEDPEERNUMBER}, ${NODEST}, 5, ${COUNT})
   same =&amp;gt; n,Set(COUNT=$[${COUNT} + 1])
   same =&amp;gt; n,Goto(_X.,6)

exten =&amp;gt; t,1,Playback(custom/zapis_7)
   same =&amp;gt; n,Hangup()

exten =&amp;gt; _[06-9],1,Playback(custom/zapis_18)
         same =&amp;gt; n,Goto(_X.,7)
exten =&amp;gt; i,1,Playback(custom/zapis_18)
   same =&amp;gt; n,Goto(_X.,7)

exten =&amp;gt; hh,1,Playback(custom/qam-end,skip)
    same =&amp;gt; n,Hangup()
&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;Добавить скрипт для обработки и отправки данных в БД /var/lib/asterisk/agi-bin/survey.php
Назначить ему права на исполнение и сменить пользователя/группу на asterisk.
Добавить и файлы из контекста ivr-qam для воспроизведения приветствия и ошибок при тайм-ауте и неверном вводе и также поправить им права.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Обзор возможностей Asterisk</title>
      <link>http://localhost:1313/instructions/asterisk-features-overview/</link>
      <pubDate>Wed, 13 Nov 2024 16:47:48 +0500</pubDate>
      <guid>http://localhost:1313/instructions/asterisk-features-overview/</guid>
      <description>&lt;h2 id=&#34;внутренние-номера&#34;&gt;Внутренние номера&lt;/h2&gt;
&lt;p&gt;Внутренние номера в Asterisk могут быть 3-х, 4-х и более значными, могут быть и двух, но двухзначными принято делать коды функций, хоть они как правило и начинаются с символа *.&lt;/p&gt;
&lt;p&gt;Каждому номеру возможно задать описание с дополнительной информацией — будь то должность человека или его Фамилия и Имя.&lt;/p&gt;
&lt;p&gt;Естественно каждому номеру необходим пароль.&lt;/p&gt;
&lt;p&gt;Так же имеется возможность распределять номерам имеющиеся внешние исходящие номера.&lt;/p&gt;
&lt;p&gt;Начиная с 13 версии появилась возможность мультирегистрации для внутренних номеров — это значит что под одним внутренним номером может быть зарегистрировано несколько устройств: настольный телефон и софтфон на смартфоне например.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Модуль детализации звонков</title>
      <link>http://localhost:1313/instructions/calls-detailed-module/</link>
      <pubDate>Wed, 13 Nov 2024 16:26:51 +0500</pubDate>
      <guid>http://localhost:1313/instructions/calls-detailed-module/</guid>
      <description>&lt;p&gt;Выглядит он так:&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_f40dca94.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Задается множество фильтров по различным параметрам, без фильтров покажет все вызовы начиная с самых последних:
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_417c6b7a.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;При наличии значка &lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_956dff7f.png&#34; alt=&#34;&#34;  /&gt;
 возможно прослушать или скачать запись кликнув по соответствующей кнопке.&lt;/p&gt;
&lt;p&gt;Возможна фильтрация по содержащимся цифрам в номере:
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_d29584df.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Причем фильтрация возможна по содержанию цифр внутри номера, в начале или конце и с использованием инверсии «&lt;strong&gt;Не&lt;/strong&gt;».
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_ed171e9a.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;При включении «Дополнительных фильтров» возможна фильтрация по входящему номеру (DID)
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/lu124487hgtwh_tmp_cfa48ff.png&#34; alt=&#34;&#34;  /&gt;
&lt;/p&gt;</description>
    </item>
    <item>
      <title>Установка модулей во FreePBX не из репозитория</title>
      <link>http://localhost:1313/articles/install-modules-freepbx-not-repository/</link>
      <pubDate>Wed, 13 Nov 2024 16:08:41 +0500</pubDate>
      <guid>http://localhost:1313/articles/install-modules-freepbx-not-repository/</guid>
      <description>&lt;p&gt;Сегодня разберем как установить модуль без доступа к репозиториям Sangoma или вообще без доступа в интернет.&lt;/p&gt;
&lt;p&gt;Заходим в модуль FreePBX &lt;strong&gt;Управление модулями&lt;/strong&gt; -&amp;gt; &lt;strong&gt;Admin&lt;/strong&gt; -&amp;gt; &lt;strong&gt;Module Admin.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Вкладка &lt;strong&gt;Module Updates&lt;/strong&gt; и жмём кнопку &lt;strong&gt;Upload Modules&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/ed6920f9f60597e1aef493207d3b0643.png&#34; alt=&#34;ed6920f9f60597e1aef493207d3b0643.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Можно выбрать как загрузку из веба, так и с жесткого диска.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/3db0d96a1f5f11e2c928aca71da99805.png&#34; alt=&#34;3db0d96a1f5f11e2c928aca71da99805.png&#34;  /&gt;
&lt;/p&gt;
&lt;h2 id=&#34;загрузка-с-жесткого-диска---2-пункт&#34;&gt;Загрузка (с жесткого диска) - 2 пункт.&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/8ef15e94ea1154f0a891f6f3707af805.png&#34; alt=&#34;8ef15e94ea1154f0a891f6f3707af805.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Жмёте Обзор, выбираете файл со своего компьютера и по нажатию кнопки Upload (From Hard Disk) он загрузится, проверится и при успешной проверке на соответствие модулю установится.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Работа с CLI Asterisk</title>
      <link>http://localhost:1313/instructions/asterisk-cli/</link>
      <pubDate>Sat, 02 Nov 2024 15:10:21 +0500</pubDate>
      <guid>http://localhost:1313/instructions/asterisk-cli/</guid>
      <description>&lt;p&gt;CLI (Command Line Interface) - очень полезный инструмент диагностики и отладки при работе с Asterisk.
Войти в него можно командой &lt;code&gt;asterisk -rvv&lt;/code&gt; (или &lt;code&gt;sudo asterisk -rvv&lt;/code&gt;), где количество &lt;code&gt;v&lt;/code&gt; (verbose) означает детальность вывода, а &lt;code&gt;r&lt;/code&gt; подключение к Asterisk.
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/7d9e0cd304f7622a74cef7eb2f41e130.png&#34; alt=&#34;7d9e0cd304f7622a74cef7eb2f41e130.png&#34;  /&gt;

При этом отобразится пользователь, от которого запущен Asterisk, его версия, имя машины, на которой запущено приложение и pid процесса.
&lt;code&gt;*CLI&amp;gt;&lt;/code&gt; означает интерактивный режим работы в CLI Asterisk.
Список всех &lt;strong&gt;доступных&lt;/strong&gt; для Вашего Asterisk команд можно узнать командой &lt;code&gt;core show help&lt;/code&gt;.
В Asterisk также отлично работает автодополнение команд, т.е. введя например &lt;code&gt;core show&lt;/code&gt; и нажав клавишу Tab оно предложит все доступные варианты:
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/d89cfd64504d754c64e789e35b8936a5.png&#34; alt=&#34;d89cfd64504d754c64e789e35b8936a5.png&#34;  /&gt;

Ещё одна удобная функция CLI - &lt;code&gt;like&lt;/code&gt;, тоесть поиск возможных вариантов среди всех доступных, например:
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/8717af5c9825cdbd75a593f41b137529.png&#34; alt=&#34;8717af5c9825cdbd75a593f41b137529.png&#34;  /&gt;

для &lt;code&gt;like&lt;/code&gt; даже доступны базовые регулярные выражения, такие как якори и диапазоны:
&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/_resources/screenshot-2024-11-02-15-11-38.png&#34; alt=&#34;Снимок экрана от 2024-11-02 15-11-38&#34;  /&gt;
&lt;/p&gt;</description>
    </item>
    <item>
      <title>Задание определенного направления (выход через конкретный транк)</title>
      <link>http://localhost:1313/articles/specifying-a-specific-direction/</link>
      <pubDate>Sat, 02 Nov 2024 14:38:41 +0500</pubDate>
      <guid>http://localhost:1313/articles/specifying-a-specific-direction/</guid>
      <description>&lt;p&gt;Для начала создаем нужный нам маршрут: &lt;strong&gt;Подключения → Исходящая маршрутизация&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/6d792aa70fd0b7d7f644c884205cf8cc.png&#34; alt=&#34;6d792aa70fd0b7d7f644c884205cf8cc.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Задаем произвольно описание , необходимый нам CallerID и транк, через который будет передаваться вызов с этим CallerID (если транк с регистрацией и допустим только один CallerID, то можно указать «&lt;strong&gt;Форсировать использование транкового CID (Force Trunk CID) в настройках транка&lt;/strong&gt;»)&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/bf2ae29dc9e282da384bee12fe2a4e07.png&#34; alt=&#34;bf2ae29dc9e282da384bee12fe2a4e07.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Задаем необходимые (допустимые) нам шаблоны набора номеров:&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/0494b10004354ef8df2036731a4db6b8.png&#34; alt=&#34;0494b10004354ef8df2036731a4db6b8.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;Можете включить запись вызова:&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;http://localhost:1313/68dfc868664b4fe78ecf2c70c1df736e.png&#34; alt=&#34;68dfc868664b4fe78ecf2c70c1df736e.png&#34;  /&gt;
&lt;/p&gt;
&lt;p&gt;После этого обязательно &lt;strong&gt;Сохраняем&lt;/strong&gt; и &lt;strong&gt;Применяем изменения.&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>О нас</title>
      <link>http://localhost:1313/about/</link>
      <pubDate>Sat, 02 Nov 2024 14:29:02 +0500</pubDate>
      <guid>http://localhost:1313/about/</guid>
      <description>&lt;p&gt;Компания Интелком более 12 лет занимается внедрением и обслуживанием мини-АТС на основе Asterisk.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
