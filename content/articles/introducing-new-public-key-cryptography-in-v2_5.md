---
title: 'Шифрование Meshtastic: эволюция от простых сообщений к универсальному решению'
date: 2026-02-08T00:21:21+05:00
draft: false
author: 'Dmitriy Q'
tags: [meshtastic, encryption, translate]
---

[Источник](https://meshtastic.org/blog/introducing-new-public-key-cryptography-in-v2_5/)

Meshtastic начался с простой цели: поддерживать связь между друзьями в походах на природе, когда сотовая связь недоступна.
То, что начиналось как простой проект, выросло благодаря увлечённому сообществу, которое расширяет границы возможного. Сегодня Meshtastic
используется в операциях поисково-спасательных служб, для связи вне сети, восстановления после катастроф и даже в ситуациях, когда
отсутствует электроснабжение. Будь то подготовка к следующему наводнению или торнадо, расширение коммуникации через Интернет с помощью MQTT
или просто наслаждение приключениями вне сети, Meshtastic стал незаменимым инструментом для многих.

### Балансировка шифрования и практического использования

Для многих шифрование Meshtastic является ключевым элементом привлекательности. На протяжении многих лет основной задачей было найти баланс:
внедрять надежное шифрование, не исключая маломощные IoT-платформы и не перегружая ограниченную пропускную способность LoRa. До версии 2.5
шифрование осуществлялось с использованием статического заранее согласованного ключа для каждого канала, который был довольно надежным.
Однако у него была одна заметная особенность: прямые сообщения (ПС).

ПС отправлялись с использованием того же общего ключа канала, а это означало, что хотя ПС теоретически были приватными, они были доступны
всем на том же канале. Единственной защитой была совесть участников сети, особенно учитывая, что стандартная настройка Meshtastic использует
общедоступный известный ключ шифрования, из-за чего ПС по умолчанию фактически оставались нешифрованными.

### Проблемы с удалённым администрированием

Удалённое администрирование также сталкивалось с трудностями. Традиционный метод заключался в создании канала «админ», позволяющего управлять
любой нодой на этом канале удалённо. У этого подхода были недостатки, особенно в том, что ноды, открытые для управления другими, также
могли быть подвержены управлению со стороны третьих лиц.

## Введение криптографии с открытым ключом (PKC) в Meshtastic

В 2022 году пользователь по имени edinnen предложил решение с помощью pull-запроса, в котором была введена схема публичного/приватного ключа
для личных сообщений. Хотя первоначальная обратная связь была многообещающей, патч со временем устарел. Недавно все совпало, и мы вернулись
к этому патчу и переработали его, сделав основой для разработки версии 2.5.

Наша новая реализация PKC теперь является ключевой функцией, предоставляя каждой ноде уникальный публичный ключ, созданный при первом запуске.
Этот ключ обеспечивает безопасное, зашифрованное соединение между нодами и служит уникальным идентификатором в сети. Он также решает проблему
удаленного администрирования — теперь ноды можно идентифицировать и авторизовывать в качестве удаленных администраторов с помощью их публичных
ключей.

### Важный шаг вперёд в области безопасности

С новой схемой PKC Meshtastic предлагает улучшенное шифрование для личных сообщений и безопасное удалённое администрирование труднодоступных нод.
Хотя мы по-прежнему предупреждаем не полагаться исключительно на шифрование Meshtastic в критических ситуациях, это обновление представляет
собой значительное достижение в области приватности и безопасности для сетей типа mesh.

### Технический разбор: механика нового шифрования Meshtastic

В основе новой системы шифрования Meshtastic лежит обмен ключами Диффи-Хеллмана на эллиптической кривой X25519. Этот процесс состоит из двух
ключевых шагов:

1. Генерация ключей: при первой загрузке каждое устройство генерирует случайный приватный ключ и на его основе создаёт соответствующий публичный
ключ с использованием алгоритма X25519. Этот публичный ключ затем транслируется в сеть как часть регулярных объявлений узла.
2. Безопасная связь: когда узел инициирует прямое сообщение, он завершает обмен ключами X25519, комбинируя свой приватный ключ с публичным ключом
получателя. Этот процесс создаёт уникальный общий секрет, который затем используется для шифрования DM. Нода-получатель может независимо вывести
тот же общий секрет, используя свой приватный ключ и публичный ключ отправителя, что обеспечивает безопасное расшифрование.

> ![Meshtastic&#39;s X25519 Key Exchange Process](https://meshtastic.org/assets/images/Meshtastic_PKC_ECDH-50c64fd014bcae6f91c1190b462eb90f.png) Рисунок 1: Визуальное представление процесса обмена ключами X25519 в Meshtastic

Схема шифрования использует AES-CCM (счетчик с CBC-MAC), обеспечивающий как конфиденциальность, так и подлинность. Важной особенностью является
включение короткого кода аутентификации сообщений (MAC), который подтверждает личность отправителя и гарантирует целостность сообщения. Для
дополнительного повышения безопасности ПС включают дополнительные 4 байта случайного числа (nonce), что эффективно предотвращает потенциальные
компрометации из-за повторного использования nonce.

Удаленное администрирование также претерпело значительные улучшения. Сообщения администратора теперь включают 8-байтовый ключ сессии,
устанавливаемый администрируемой нодой. Этот ключ включается в ответы и должен присутствовать в любом пакете, пытающемся вносить изменения.
С тайм-аутом в 300 секунд этот механизм обеспечивает надежную защиту от повторных атак на перехваченный административный трафик.

## Заключение

Путь Meshtastic от простого инструмента для связи во время походов до универсального и безопасного решения для mesh-сетей демонстрирует силу
разработки, ориентированной на сообщество. Введение нашей новой схемы криптографии с открытым ключом в версии 2.5 представляет собой значительный
шаг вперёд в возможностях безопасности платформы, решая давние проблемы с прямыми сообщениями и удалённым администрированием.

По мере того как мы продолжаем совершенствовать и расширять функции Meshtastic, мы остаёмся привержены сочетанию надёжной безопасности с
практичной удобностью использования. Хотя это обновление значительно повышает конфиденциальность и безопасность платформы, мы призываем
пользователей подходить к вопросам шифрования с пониманием его сильных и слабых сторон, особенно в критических ситуациях.

Смотря в будущее, мы с воодушевлением оцениваем возможности, открываемые этой новой криптографической платформой. Мы приглашаем наше сообщество
исследовать эти новые функции, делиться отзывами и продолжать раздвигать границы возможного с Meshtastic. Вместе мы строим более безопасное и
связное будущее для связи вне сети.