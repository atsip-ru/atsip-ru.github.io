---
title: 'Выбор правильной роли устройства Meshtastic'
date: 2025-02-05T13:09:52+05:00
draft: false
author: 'Dmitriy Q'
tags: [meshtastic, role, translate]
---

[Источник](https://meshtastic.org/blog/choosing-the-right-device-role/)

При настройке вашей сети Meshtastic, правильная конфигурация роли для каждого устройства может быть решающей для оптимизации производительности и обеспечения надежной связи. И наоборот, ошибки выбора неправильной роли могут привести к перегрузке и плохой производительности сети. В этом посте мы рассмотрим, почему следует выбирать определенные роли устройств и избегать других.

## Что такое роль устройства?

Роль устройства в Meshtastic определяет главную функцию устройства в сети. Каждая роль адаптирована к конкретному использованию и помогает более эффективно управлять сетью и поведением устройства. Вот некоторые из общих ролей устройства, которые следует учитывать:
### Client

Фактическая роль для устройств - `CLIENT`. Это гибкая, универсальная роль для устройств, которые должны обслуживать подавляющее большинство случаев использования. Если вы сомневаетесь в том, какую роль следует выбрать, то просто остаться клиентом - это безопасная ставка.

Несмотря на очевидный багаж термина *клиент* в некоторых технологических контекстах, клиенты в Meshtastic фактически повторяют / перенаправляют сообщения. К сожалению, в прошлом это вызывало некоторую путаницу, заставляя некоторых людей неправильно выбирать роль `ROUTER`.
### Client mute

Роль `CLIENT_MUTE` аналогична роли `CLIENT`, но с одним ключевым отличием: она не повторяет и/или не перенаправляет сообщения. Эта роль идеально подходит для устройств, предназначенных для использования в районах с высоким уровнем сетевого трафика, где дополнительная маршрутизация сообщений может привести к перегрузке. Используя роль `CLIENT_MUTE`, вы можете гарантировать, что устройство будет только отправлять и получать свои собственные сообщения без участия в сетевом трафике.

Эта роль также очень рекомендуется, если вы предпочитаете сети с несколькими устройствами. Выберите одно из своих устройств для использования в качестве `CLIENT` или `CLIENT_BASE` а на остальные устройства установите режим `CLIENT_MUTE`, чтобы использовать эфирное время более ответственно.
### Client Base

Роль `CLIENT_BASE` аналогична `CLIENT`, но имеет приоритет при ретрансляции сообщений из или в любую из своих избранных нод. Для энтузиастов сети с несколькими устройствами, эта роль идеально подходит для обеспечения всех ваших близлежащих нод в полной мере использовать ваши более сильные, хорошо расположенные ноды "базовые станции" на чердаке/крыше.

Если у вас есть нода на чердаке/крыше, установите ей `CLIENT_BASE`. А другие ноды (как правило, `CLIENT` или `CLIENT_MUTE`) установите в качестве избранных на `CLIENT_BASE`.
### Router и Repeater

Роль `ROUTER` предназначена для устройств, которые предназначены главным образом для передачи сообщений другим устройствам в сети. Эта роль подходит ТОЛЬКО для стационарных устройств, размещенных в крайне стратегических местах, чтобы выступать в качестве неофициальных узлов для маршрутизации пакетов в сети. Маршрутизаторы фокусируются на ретрансляции сообщений с других устройств,  *отрезая линию* до того, как другие узлы получат шанс ретранслировать сообщение, что делает их ключом к расширению диапазона и надежности вашей сети. Кроме того, маршрутизаторы *всегда* ретранслируют, в то время как большинство других ролей потенциально предпочитают отказаться от ретрансляции, если они услышат повторное вещание соседа.

Другое поведение маршрутизаторов по умолчанию заключается в том, что устройство пытается сэкономить как можно больше энергии, пытаясь переходить в режим сна, а также отправлять пакеты телеметрии реже, чем другие устройства в сети. Это потому, что они главным образом отвечают за маршрутизацию чужого трафика, а не отправку своих собственных сообщений.

Роль `REPEATER` очень похожа на  `ROUTER`, с точки зрения превращения в предпочтительное устройство для маршрутизации пакетов, однако она идет еще дальше, полностью отключая любой транслируемый трафик, такой как телеметрия. Он отвечает только другим нодам вместо исходящих сообщений.
#### Что такое стратегическое расположение на самом деле?

При оценке стратегических местоположений для этих двух ролей, рассмотрите башню на вершине горы, а не высокий этаж в здании. Выбирая устройство для роли маршрутизатора или ретранслятора, вы фактически делаете выбор в пользу того, чтобы вся mesh-сеть предпочитала этот узел при ретрансляции данных для любых прямых соседей. Такое стратегическое размещение становится критически важным для обеспечения доставки пакетов как можно большей аудитории. Рекомендуется использовать инструменты обследования территории с прямой видимостью для определения оптимального места, но лучший выбор можно сделать сначала собрав реальные данные о mesh-сети.

![Router](https://meshtastic.org/assets/images/router_not_router-793d604ef9fe5210832949643c6e1561.png)

#### Почему неправильное использование ролей маршрутизатора и повторителя вредно

Если для маршрутизаторов и репитеров (повторителей) выбрано неподходящее место, это может вызвать ряд проблем:

1. Повышенная частота коллизий пакетов

Поскольку маршрутизаторы и ретрансляторы всегда повторно передают сигнал, когда слишком много устройств выполняют эти роли и находятся в непосредственной близости друг от друга, пакеты потенциально могут передаваться одновременно, создавая повышенный уровень шума и приводя к ошибкам пакетов. Это часто заканчивается периодическими сбоями в доставке.

2. Сниженный общий диапазон

Неправильно установленный маршрутизатор потенциально может преждевременно *поглотить хоп* любого пакета, проходящего через него. Это приводит к тому, что хоп маршрутизации пакета используется раньше времени, прежде чем он сможет достичь более стратегически важную расположенную ноду. Это может значительно ограничить диапазон, например, в случае, когда множество маршрутизаторов установлены в долине, используя все доступные хопы, прежде чем пакет сможет достичь своей цели через более стратегически значимую ноду на вершине над долиной.

3. Асимметричные соединения

Аналогично проблеме уменьшенного радиуса действия, та же ситуация может привести к асимметричной связи, когда часть сети может отправлять сообщения другой группе, но эта группа не может ответить из-за того, что неправильно расположенные маршрутизаторы преждевременно расходуют количество хопов до того, как сообщение успевает доставиться. Это явление также может вызвать реакцию пользователей, повышающих лимит хопов для компенсации проблемы, что, к сожалению, еще больше увеличивает нагрузку на сеть за счет большего использования эфирного времени.

### Sensor

Роль `SENSOR` предназначена для устройств, которые в первую очередь собирают и передают данные датчиков. Эти устройства по-прежнему участвуют в маршрутизации сообщений для других устройств, но они отдают приоритет отправке собственных телеметрических данных в сеть, даже при высокой загрузке канала. Эта роль идеально подходит для мониторинга окружающей среды, метеостанций или любых приложений, где основная функция устройства — сбор и передача телеметрии.

Используя роль `SENSOR` в сочетании с `power.is_power_saving`, устройство будет пытаться переходить в спящий режим между интервалами отправки телеметрии окружающей среды, что значительно увеличивает время работы устройств при использовании этой комбинации настроек.
### Tracker

Роль `TRACKER` предназначена для устройств, которые в основном используются для отслеживания местоположения ресурсов, транспортных средств или людей. Устройства с этой ролью периодически отправляют свои координаты GPS в сеть через пакеты позиции с более высоким приоритетом, что позволяет более надежно отслеживать местоположение. Трекеры также участвуют в маршрутизации сообщений, но их главная цель — предоставлять актуальные данные о местоположении, даже при высокой загрузке канала.

Используя роль `TRACKER` в сочетании с `power.is_power_saving`, устройство будет пытаться переходить в спящий режим между интервалами отправки данных о местоположении, что значительно увеличивает время работы устройств при использовании этой комбинации настроек.
### Вывод

Выбор правильной роли устройства имеет решающее значение для производительности и надежности вашей сети Meshtastic. Понимая различия между общими ролями, вы можете оптимизировать сетевую конфигурацию для удовлетворения ваших конкретных потребностей и обеспечить эффективную коммуникацию на всех устройствах. Для получения дополнительной технической информации о каждой роли, посетите документацию [device configuration](https://meshtastic.org/docs/configuration/radio/device/#roles).