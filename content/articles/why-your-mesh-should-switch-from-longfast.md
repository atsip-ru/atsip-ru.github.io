---
title: 'Задерживает ли LongFast ваш Mesh? Лучшие LoRa-настройки для больших Meshtastic сетей'
date: 2026-02-05T13:09:52+05:00
draft: false
author: 'Dmitriy Q'
tags: [meshtastic, translate]
---

[Источник](https://meshtastic.org/blog/why-your-mesh-should-switch-from-longfast/)

Если ваша локальная сеть Meshtastic выросла за пределы нескольких нод и вы начали сталкиваться с такими проблемами, как задержки доставки
сообщений, перегрузка сети или нестабильные результаты, причиной может быть предустановка вашей LoRa-радиостанции. Конкретно, вы могли перерасти
стандартную предустановку: LongFast.

Хотя LongFast является отличной универсальной предустановкой для многих пользователей, она может быть не оптимальным выбором для крупных или
более плотных сетей. В этом посте мы объясним, почему переход на предустановки с более высокой пропускной способностью может значительно улучшить
производительность сети.

## Понимание предустановок LoRa

Устройства Meshtastic используют радиосвязь LoRa (Long Range) для общения, балансируя три ключевых фактора: дальность, скорость и надежность. Эти факторы регулируются с помощью таких настроек, как ширина канала, коэффициент распространения и скорость кодирования, которые удобно объединены в «предустановки».

**Стандартная** предустановка, LongFast, использует ширину канала 250 кГц с коэффициентом распространения 11. Эта конфигурация обеспечивает отличную дальность сразу из коробки, но за счет относительно медленной передачи данных (около 1 кбит/с).

Вот как некоторые предустановки сравниваются на бумаге:

| Предустановка | Ширина канала (kHz) | КР     | Скорость передачи (kbps) | Бюджет канала | Подходит для                                 |
| ------------- | ------------------- | ------ | ------------------------ | ------------- | -------------------------------------------- |
| **LongFast**  | **250**             | **11** | **1.07**                 | **153dB**     | **Умолчания**                                |
| MediumSlow    | 250                 | 10     | 1.95                     | 150.5dB       | Лучшая скорость                              |
| MediumFast    | 250                 | 9      | 3.52                     | 148dB         | Быстрота с хорошим радиусом действия         |
| ShortSlow     | 250                 | 8      | 6.25                     | 145.5dB       | Быстрота с умеренным диапазоном              |
| ShortFast     | 250                 | 7      | 10.94                    | 143dB         | Очень быстро, короткая дальность             |
| ShortTurbo    | 500                 | 7      | 21.88                    | 140dB         | Максимальная скорость, минимальная дальность |

## Проблема с LongFast в больших / плотных сетях

Хотя LongFast обеспечивает большую дальность, у неё есть недостатки, которые становятся всё более серьёзными по мере роста вашей сети:

1. **Увеличенное время использования канала**: Сообщения LongFast дольше находятся «в эфире» по сравнению с некоторыми более быстрыми настройками,
занимая драгоценное время канала. При более медленных скоростях передачи каждый сеанс занимает канал дольше, не позволяя другим нодам передавать
данные в этот промежуток.
2. **Более высокая вероятность коллизий**: Когда несколько нод пытаются передавать данные в загруженной сети, вероятность коллизий пакетов
значительно возрастает при медленных настройках, потому что каждая передача блокирует канал дольше.
3. **Снижение пропускной способности**: Сочетание вышеупомянутых факторов приводит к уменьшению фактической пропускной способности всей сети,
даже если LongFast кажется надёжным для передачи сообщений. В большой или плотной сети это может привести к перебоям в работе и разочарованию пользователей.

## Преимущества пресетов с высокой пропускной способностью

Переход на пресеты с более высокой пропускной способностью, такие как MediumSlow, MediumFast, ShortSlow или даже ShortFast, предлагает ряд
преимуществ:

1. **Сокращение времени передачи**: Сообщения передаются быстрее, освобождая канал для общения других нод.
2. **Снижение вероятности коллизий**: При более коротком времени передачи вероятность того, что две ноды попытаются передать данные одновременно,
уменьшается.
3. **Лучшая масштабируемость**: Пресеты с высокой пропускной способностью предназначены для работы с большим количеством нод и более высоким
объемом сообщений, что делает их более подходящими для крупных сетей. В плотных сетях улучшенная пропускная способность часто с лихвой компенсирует слегка уменьшенную дальность, что приводит к более надежной доставке сообщений.
4. **Снижение задержек**: Сообщения быстрее проходят через сеть, уменьшая задержки, что делает использование более комфортным для пользователей.

> График водопада SDR пакетов на нескольких различных пресетах (слева направо): LongFast, MediumFast, ShortFast ![Presets](/_resources/longfast-1.webp)

## Когда следует менять?

Вам, возможно, стоит рассмотреть возможность перехода от LongFast, если в вашей сети:

- **Более 60 нод**, особенно если они находятся относительно близко друг к другу
- **Высокий объем сообщений** от множества пользователей или автоматизированных систем
- **Городское или пригородное развертывание**, где максимизация дальности менее важна, чем пропускная способность
- **Наблюдаются задержки сообщений** или непостоянная доставка из-за перегрузки сети

#### Для чрезвычайно плотных сетей

**ShortFast** или **ShortSlow** - эти предустановки обеспечивают максимально высокие скорости передачи данных, значительно снижая перегрузку
каналов. Хотя дальность меньше, в городских условиях ноды обычно расположены достаточно близко друг к другу, поэтому это может не быть
значительной проблемой.

#### Для плотных городских / пригородных сетей

**MediumFast** или **MediumSlow** — эти предустановки обеспечивают отличное сочетание дальности и скорости, предлагая скорость передачи данных
в 3-4 раза выше, чем у LongFast, при этом сохраняя достойную дальность.

## Внесение изменений

Смена предустановок проста, но требует обновления всех нод в вашей сети:

1. **Веб-интерфейс**: Перейдите в Radio > LoRa и измените выпадающий список «Modem Preset»
2. **Meshtastic CLI**: Используйте команду `meshtastic --set lora.modem_preset MEDIUM_FAST` или аналогичную
3. **Приложение для Android/iOS**: Перейдите в Настройки > Радио > LoRa > Modem Preset

Помните: все ноды в вашей сети должны использовать один и тот же пресет, чтобы оставаться в сети.

Пожалуйста, ознакомьтесь со страницей [LoRa Config](https://meshtastic.org/docs/configuration/radio/lora/) для получения дополнительной информации.

### Успехи в реальной жизни

Многие крупные развертывания Meshtastic заметили значительные улучшения после перехода с LongFast, одним из таких примеров является группа
Meshtastic Bay Area:

#### Группа Meshtastic Bay Area

Meshtastic Bay Area — это сообщество mesh в районе залива Сан-Франциско, которое переключило свой пресет на MediumSlow. Вот их отзыв об этом
изменении:

Наша сеть из более чем 150 нод в настоящее время процветает после перехода на пресет MediumSlow, который оказался чрезвычайно полезным. Всё
началось как эксперимент, чтобы выйти из перегруженного канала по умолчанию LongFast, в котором было много нод с устаревшей прошивкой или неправильно настроенных нод, засоряющих сеть.

Вот что обеспечивает её работу:

1. **Целенаправленная координация**: Наш переход на MediumSlow был тщательно спланирован. Роли нод были продуманно распределены, таймеры
настроены, а структура сети оптимизирована для покрытия и надёжности. Регулярная координация — как в сети, так и за её пределами — позволяет
быстро выявлять и решать проблемы. Человеческий фактор за технологией является ключевым элементом нашего успеха.
2. **Меньше фонового шума:** MediumSlow не является стандартным пресетом, поэтому мы избегаем старого трафикового хаоса, накопленного за годы
использования LongFast. Это само по себе значительно повышает ясность сети.
3. **Современная прошивка и лучшие практики на всех нодах:** Поскольку миграция была недавней и преднамеренной, почти все устройства работают
на актуальной прошивке, что снижает количество ошибок и повышает стабильность. Мы придерживаемся лучших практик настройки и стараемся
минимизировать ненужный трафик, который не приносит пользы.
4. **Стратегическое размещение нод:** Мы оставляем режим маршрутизатора для нод на большой высоте, обеспечивая широкое покрытие без лишнего
дублирования. Высота имеет значение — и мы используем это в наших интересах. Иногда мы размещаем 2 маршрутизатора на противоположных концах
определённой зоны, чтобы обеспечить высокую вероятность прямой видимости.
5. **Приветствуем любопытство и эксперименты:** Мы часто проверяем границы, проводим эксперименты и в целом «пробуем разные вещи», чтобы учиться
и проверять предположения. Это гарантирует, что производительность и поведение сети mesh понятны, а изменения подкреплены результатами и
повторяемой наукой.

![Meshtastic Bay Are Group Mesh](/_resources/longfast-2.webp)

#### Сеть региона Веллингтон (Новая Зеландия)

Эта сеть среднего размера охватывает несколько сотен квадратных километров смешанных городских, пригородных и сельских территорий в южной
части Северного острова Новой Зеландии и часть северной части Южного острова. Население распределено по сложной местности, что может затруднять
обеспечение хорошего покрытия. Мы перевели всю сеть с LONG_FAST на SHORT_FAST в течение недели, к концу августа 2024 года.

К третьему кварталу 2024 года наша сеть выросла до более чем 150 активных узлов и испытывала значительные проблемы с перегруженностью. В тот
период мы использовали стандартную предустановку LONG_FAST чтобы стимулировать её использование, но количество трафика в сети делает её
непригодной, с наблюдаемыми пиками использования каналов на загруженных местах достигая более 65%. Это в значительной степени состояло из
nodeinfo, местоположениях и обновлений телеметрии от клиентов. Большинство функций, включая текстовые сообщения, были крайне ненадежными - и
всплески трафика могли на некоторое время полностью нарушить работу сети. Наша сеть, к счастью, никогда не испытывала проблем с "беспорядочными"
маршрутизаторами, которые наблюдались в других местах, из-за хорошей (и ранней) координации между нашими операторами высоких мест, чтобы
обеспечить всеобъемлющий охват с самого начала. Тем не менее, из-за нашей топографии нам требуется выше среднего количества маршрутизаторов
для того, чтобы обеспечить надлежащий охват населенных районов, и эти маршрутизаторы конкурировали друг с другом за ограниченное эфирное время.

Мы начали с временного перевода пары ключевых высокоприоритетных мест на SHORT_FAST для краткого двухчасового теста, чтобы быстро получить
первоначальное представление о том, насколько реалистичен будет переход на более быстрый профиль. Мы также рассматривали MEDIUM_FAST, но в
конечном итоге решили, что SHORT_FAST будет лучшим вариантом для долгосрочной стратегии, при условии, что это будет реально осуществимо. Перенос
сети казался большой задачей, и мы не хотели бы проходить через это снова позже, если бы мы пошли на компромисс с чем-то, что все еще слишком
медленно для будущего роста. Этот первоначальный тест прошел успешно.

Как только концепция была подтверждена, мы организовали тестовый день, в ходе которого перевели все ключевые высотные узлы региона на SHORT_FAST
на 24 часа, чтобы дать возможность провести эксперименты по всему региону с полностью связной сетью. Об этом заранее было объявлено через
социальные сети и по самой сети. Тестовый день прошёл успешно и показал, что у SHORT_FAST остаётся достаточно хороший бюджет канала, так что все,
кроме нескольких очень незначительных, соединений продолжат работать. Это также позволило нам проверить правильность наших предположений
относительно последовательности изменений высотных узлов, чтобы убедиться, что мы можем сделать всё с помощью удалённого администрирования —
что позволяет быстро реализовать миграцию и легко откатить её в случае проблем.

В конце августа мы инициировали миграцию всей сети на SHORT_FAST, используя стандартную частоту для этого предустановленного режима (это означало,
 что пользователям нужно было изменить только одну настройку от значения по умолчанию, чтобы подключиться к нашей сети). О переходе было
 объявлено через социальные сети, а также проводился активный спам в публичном чате LongFast с пояснительным текстом и ссылкой на страницу с
 более подробной информацией о переходе и ресурсами, где пользователи могли получить помощь. 31 августа все ключевые крупные узлы были
 одновременно переведены на SHORT_FAST, а временные дополнительные маршрутизаторы LONG_FAST были размещены на критически важных нодах, чтобы мы
 могли продолжать спам в публичном канале LONG_FAST и убедиться, что все пользователи знают о смене. К последующим выходным почти все пользователи
  обновили настройки своих нод, и все, кроме двух временных маршрутизаторов LONG_FAST, были выведены из эксплуатации. Эти два маршрутизатора
  оставались на местах еще три месяца, чтобы заметить любых отстающих, которым может понадобиться помощь — к счастью, таких осталось считанное
  количество.

Производительность на SHORT_FAST была чрезвычайно хорошей, с очень надежной работой, включая наш самый протяженный постоянный канал (254 км между
двумя ключевыми высотными точками). Пакеты надежно проходят через всю сеть без проблем и очень быстро. Уменьшенная задержка также значительно
улучшила пользовательский опыт.

Еще одним значительным преимуществом более быстрого режима стала возможность использовать некоторый дополнительный запас мощности канала для
лучшего обслуживания городских «черных зон» (затрудненных для связи с нашими основными маршрутизаторами из-за рельефа), которые ранее было
невозможно покрыть. С декабря 2024 года мы развернули несколько узлов ROUTER_LATE для покрытия этих зон — эти узлы гарантируют, что наши бывшие
«черные зоны» теперь имеют путь в более широкую сеть, и оказались чрезвычайно полезными.

### Как уговорить других переключиться / Как справиться с FOMO

Если вы состоите в сообществе или группе, где другие все еще используют LongFast, подумайте о том, чтобы поделиться своим опытом и преимуществами,
которые вы заметили. Вы также можете помочь им понять компромиссы, связанные с переходом на другие настройки. Это может быть отличной возможностью
рассказать другим о важности оптимизации сети и о том, как это может улучшить производительность для всех. Для тех, кто колеблется с переходом,
напомните, что стандартная настройка LongFast не является универсальным решением. Поощряйте их экспериментировать с разными настройками и находить
то, что лучше всего подходит для их конкретной ситуации.

Некоторые группы, которые перешли на настройки с большей пропускной способностью, оставили бота на LongFast, чтобы отправлять сообщения и
перенаправлять тех, кто еще не сменил настройки, в новый канал. Это позволяет обеспечить плавный переход и гарантирует, что никто не останется
вне новой сети, пока обдумывает изменение.
## Почему Meshtastic просто не изменит стандартный пресет?

Проект Meshtastic изначально был ориентирован на исходный сценарий использования — небольшие частные уличные mesh-сети, а не на большие публичные,
существующие сегодня. LongFast остается стандартной предустановкой, потому что она предлагает хороший баланс между дальностью и скоростью для многих
пользователей, особенно для новичков и небольших сетей. Однако по мере роста сетей эта предустановка становится менее оптимальной по причинам,
которые мы рассмотрели выше. Изменение стандартной предустановки также нарушило бы обнаружение существующих узлов, так как они будут использовать
разные каналы. Это приведет к путанице и разочарованию у пользователей, которые не осведомлены об изменении. Для Meshtastic 3.0 мы рассматриваем
возможность новой стандартной предустановки, более подходящей для все более популярных больших сетей, но работа над этим еще продолжается.

## So long, LongFast!

Хотя LongFast является отличной настройкой по умолчанию, обеспечивающей баланс между дальностью и скоростью для малых и средних сетей, более
крупные или плотные развертывания часто получают значительную выгоду от перехода на предустановки с более высокой пропускной способностью.

Немного сокращённый теоретический диапазон обычно компенсируется улучшенной надежностью, меньшей задержкой и лучшим общим пользовательским опытом,
 особенно в сценариях, когда узлы располагаются относительно близко друг к другу.

Если ваша сеть развилась более чем на несколько нод или вы сталкиваетесь с проблемами, связанными с перегрузкой сети, стоит поэкспериментировать
с альтернативными предустановками, чтобы найти оптимальную конфигурацию для вашей сети.