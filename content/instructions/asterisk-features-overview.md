+++
title = 'Обзор возможностей Asterisk'
date = 2024-11-13T16:47:48+05:00
draft = false
author = 'Dmitriy Q'
+++
## Внутренние номера

Внутренние номера в Asterisk могут быть 3-х, 4-х и более значными, могут быть и двух, но двухзначными принято делать коды функций, хоть они как правило и начинаются с символа \*.

Каждому номеру возможно задать описание с дополнительной информацией — будь то должность человека или его Фамилия и Имя.

Естественно каждому номеру необходим пароль.

Так же имеется возможность распределять номерам имеющиеся внешние исходящие номера.

Начиная с 13 версии появилась возможность мультирегистрации для внутренних номеров — это значит что под одним внутренним номером может быть зарегистрировано несколько устройств: настольный телефон и софтфон на смартфоне например.

Есть возможность включения ожидания вызова (ещё называют второй линией), но учтите — при этом второму входящему вызову будут поступать гудки, а не сигнал «занято» и люди будут думать что оператор просто не берет трубку, но зато оператор будет видеть второй входящий вызов и при его поступлении сможет переключиться на него.

Так же есть возможность записи вызовов номера — как внешних, так и внутренних.

На номерах возможно настроить голосовую почту и перенаправление вызова, но об этом чуть позже.

При неответе номера (время вызова так же можно указывать индивидуально) вызов можно направить на другое назначение (в том числе голосовую почту и перенаправление вызова, на группу номеров или очередь), аналогично можно указать в случае занятости номера (или просто включить запись что «Номер занят — перезвоните позднее») и недоступности.

## Конференц-связь

Конференц-связь в Asterisk используется для проведения конференций.

Основные возможности конференц-связи:

- Воспроизведение сообщения при входе

- Функция ожидания/покидания организатора - конференция не начнется пока не войдет организатор и закончится когда огранизатор её покинет

- Оповещение о вновь присоединяющихся участниках

- Оповещение о количестве участников

- Запись и воспроизведение имени присоединившегося участника

- Ограничение максимального количества участников


## Перенаправление вызова (Следуйте сюда)

При перенаправлении вызова вызов может быть направлен на внутренние номера (да — их может быть несколько, но в разумных пределах) или внешние номера (имейте ввиду ваше количество исходящих линий).

В последних версиях Asterisk добавлена возможность совпадений по календарю.

Задается начальное время вызова — вызов первого номера, время вызова всех номеров (при вызове всех одновременно) или каждого в списке (при переборе).

Стратегии вызова:

- **звонят-все-2**: продолжительность звонка устанавливается как в «Начальное время звонка», затем продолжается вызов внутреннего номера и вызывается список «Следуйте-сюда» по продолжительности, установленной во «Время звонка»;

- **звонят-все**: продолжительность звонка устанавливается как в «Начальное время звонка», затем прекращается вызов внутреннего номера и вызывается список «Следуйте-сюда» по продолжительности, установленной во «Время звонка»;

- **поиск**: по очереди звонит каждый доступный номер;

- **поиск-перебором**: звонит первый внутренний номер в списке, затем первый и второй, затем первый, второй и третий в списке… итд;

- **\*-перв**: эти режимы действуют как описано выше, за исключением того, что если основной внутренний номер (первый из списка) занят, следующие по списку звонить не будут. Если основной номер в режиме «Не Беспокоить» режим запущен не будет. Если основной номер в режиме безусловной «Переадресации вызовов», то режим продолжит работу;

- **первый-доступный**: звонит только первый доступный канал;

- **первый-не-на-телефоне**: звонит только первый канал, у которого не снята трубка - ожидание вызова игнорируется


Так же имеется возможность задания музыки на ожидание вместо гудков и добавления префикса перед именем для внутренних абонентов.

И для внешних номеров возможно задать номер, отображаемый при переадресации (учтите — редко какие операторы пропускают чужие номера).

## Голосовая почта

Голосовая почта используется для оставления сообщений при недоступности номера или вне рабочее время.

Есть возможность установки пароля.

Так же имеется возможность отправки сообщений на электронную почту (учтите — иногда почтовые системы воспринимают это как спам) с прикрепленной записью сообщения и даже с последующим удалением сообщения с сервера, так же опционально включатся воспроизведение номера абонента и дата/время вызова.

## Интерактивное голосовое меню (IVR)

Когда вы звоните в какое-либо учреждение где Вам предлагается ввести цифру для вызова определенного отдела или ввести добавочный номер сотрудника — вы попадаете на систему голосового меню.

Голосовые меню прошли долгий путь эволюции от простого перевода на сотрудников до многослойных меню с добавлением собственных функций: узнать состояние лицевого счета или передать показания приборов учёта.

Возможности:

- добавление перенаправления при наборе цифры (или цифр)

- переход по тайм-ауту (который так же задается)

- переход по неверному набору (с возможность добавления уведомления и нескольких попыток)


## Группы вызова

Группы вызова как следует из названия созданы для набора нескольких номеров.

Стратегии вызова:

- **звонят-все**: Обзвоните все доступные каналы до тех пор, пока один из них не ответит (по умолчанию);

- **поиск**: Вызывается по очереди каждый доступный добавочный номер;

- **поиск-перебором**: Звонит первый номер в списке, затем 1-й и 2-й номера, затем 1-й, 2-й и 3-й номера в списке.... и т.д. Эта стратегия будет работать только при отключенном подтверждении вызовов;

- **\*-перв**: Эти режимы действуют так, как описано выше. Однако, если первичный номер (первый в списке) занят - другие не будут вызваны. Если на первичном включен DND - он не будет звонить. Если на первичном установлен безусловный CF - то все будет звонить;

- **первый-доступный**: звонит только первый доступный канал. Эта стратегия будет работать только тогда, когда подтверждение вызовов отключено;

- **первый-не-на-телефоне**: звонит только первый канал, который не используется, игнорируя ожидание вызова. Эта стратегия будет работать только тогда, когда отключено подтверждение вызовов;

- **случайный**: Делает возможным переключение между включенными добавочными номерами без предопределенного приоритета, чтобы гарантировать, что вызовы в группах равномерно (почти) распределены. Имитирует очередь, когда очередь не может быть использована иначе.


Возможно задание времени отработки на каждом шаге или всего для стратегии **звонят-все**.

Так же есть возможность установки музыки на ожидание вместо гудков, добавления префикса к имени и пропуска занятого оператора.

Так же по истечении времени вызова можно задать направление на следующее назначение (например эта же или другая группа или номер приемной).

## Очереди

**Очереди** — это гибкий и мощный инструмент для обработки входящих вызовов.

Основные возможности:

- Воспроизведение сообщения при попадании в очередь

- Воспроизведение музыки или рекламы во время ожидания в очереди

- Выбор различных стратегий вызова агентов очереди

- Распределение всех абонентов по доступным агентам очереди


### Стратегии вызова:

- **звонят-все** **(ringall)**: вызывать всех доступных агентов, пока один из них не ответит (по умолчанию)

- **недавний** **(leastrecent)**: вызывать агента, который был последним вызван этой очередью

- **менее-вызываемый** **(fewestcalls)**: вызывается агент с наименьшим количеством завершенных вызовов в данной очереди

- **случайный** **(random)**: вызвать случайного агента

- **запоминающая** **(rrmemory)**: круговой алгоритм с памятью, запоминает где мы остановились на последнем вызове

- **упорядоченная** **(rrordered)**: тоже самое, что и запоминающая, за исключением того, что порядок участников очереди из файла конфигурации сохраняется

- **линейная** **(linear)**: вызывать агентов в указанном порядке, для динамических агентов в том порядке, в котором они вошли в систему

- **весово-случайная** **(wrandom)**: случайным образом с использованием штрафа участника в качестве весового коэффициента, подробности см. в документации по Asterisk


Участники очереди бывают статическими (жестко прикрепленными к очереди) и динамическими (могут входить и выходить из очереди).

Благодаря свободному вхождению (которое кстати можно ограничить) заместить «заболевшего» сотрудника становится возможно другому оператору.

## Правила по времени/календарю

Позволяют задавать различные направления в зависимости от дня недели/числа месяца/месяца/времени.

Например: днем вызовы могут попадать на голосовое меню, а в нерабочее время на сообщение с просьбой оставить голосовое сообщение, при этом в одно правило может быть вложено другое с иным графиком работы и система будет перебирать их по очереди при совпадении условий.

## Доступ к системе извне (DISA)

Интересное приложение, позволяющее подключиться к системе (задав определенный номер или путем ввода пин-кода) и там уже набирать внутренние номера или делать вызовы на внешние номера с самой АТС, т.е. за счет компании.

## Коды функций

Довольно обширный модуль, включающий возможности:

- добавление в черный список

- управление перенаправлением вызовов

- включение ожидания вызова

- перехват вызова

- шпионский канал

- перевод вызова: с уведомлением и без

- запись вызова при необходимости

- переключение следуйте-сюда

- произношение вашего внутреннего номера

- говорящие часы

- вход/выход из очереди вызовов

- переключение режимов работы правил по времени

- доступ к голосовой почте


## Записи деталей вызова (CDR)

Система, позволяющая просмотреть сделанные вызовы и при включенной записи прослушать или скачать запись разговора.

Есть возможность задать множество фильтров: по исходящему внутреннему номеру, по назначению, по исходящему CallerID или входящему номеру DID.